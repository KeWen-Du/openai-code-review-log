### ä»£ç å˜æ›´è®°å½• git diff
diff --git a/openai-code-review-sdk/src/main/java/dkw/middleware/sdk/OpenAiCodeReview.java b/openai-code-review-sdk/src/main/java/dkw/middleware/sdk/OpenAiCodeReview.java
index bec4f78..bb363c2 100644
--- a/openai-code-review-sdk/src/main/java/dkw/middleware/sdk/OpenAiCodeReview.java
+++ b/openai-code-review-sdk/src/main/java/dkw/middleware/sdk/OpenAiCodeReview.java
@@ -42,7 +42,7 @@ public class OpenAiCodeReview {
         logger.info("openai-code-review done!");
     }
 
-    public static String getEnv(String key) {
+    private static String getEnv(String key) {
         String value = System.getenv(key);
         if (null == value || value.isEmpty()) {
             throw new RuntimeException(key + " value is null");
diff --git a/openai-code-review-sdk/src/test/java/dkw/middleware/sdk/test/ApiTest.java b/openai-code-review-sdk/src/test/java/dkw/middleware/sdk/test/ApiTest.java
index 85913ce..fc841ea 100644
--- a/openai-code-review-sdk/src/test/java/dkw/middleware/sdk/test/ApiTest.java
+++ b/openai-code-review-sdk/src/test/java/dkw/middleware/sdk/test/ApiTest.java
@@ -1,22 +1,7 @@
 package dkw.middleware.sdk.test;
 
-import com.alibaba.fastjson2.JSON;
-import dkw.middleware.sdk.infrastructure.openai.dto.ChatCompletionSyncResponseDTO;
 import dkw.middleware.sdk.types.utils.BearerTokenUtils;
-import dkw.middleware.sdk.types.utils.WXAccessTokenUtils;
-import org.junit.Test;
 
-import java.io.BufferedReader;
-import java.io.InputStreamReader;
-import java.io.OutputStream;
-import java.net.HttpURLConnection;
-import java.net.URL;
-import java.nio.charset.StandardCharsets;
-import java.util.HashMap;
-import java.util.Map;
-import java.util.Scanner;
-
-import static dkw.middleware.sdk.OpenAiCodeReview.getEnv;
 
 public class ApiTest {
 
@@ -26,144 +11,4 @@ public class ApiTest {
         System.out.println(token);
     }
 
-    @Test
-    public void test_http() throws Exception {
-        String ak = "8751544afb8b574a2d3a717bed8bf86e.NR9C8vqi6DIhbSJh";
-        String token = BearerTokenUtils.getToken(ak);
-
-        URL url = new URL("https://open.bigmodel.cn/api/paas/v4/chat/completions");
-        HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();
-
-        httpURLConnection.setRequestMethod("POST");
-        httpURLConnection.setRequestProperty("Authorization", "Bearer " + token);
-        httpURLConnection.setRequestProperty("Content-Type", "application/json");
-        httpURLConnection.setRequestProperty("User-Agent", "Mozilla/4.0 (compatible; MSIE 5.0; Windows NT; DigExt)");
-        httpURLConnection.setDoOutput(true);
-
-        String code = "1+1";
-
-        String jsonInpuString = "{"
-                + "\"model\":\"glm-4-flash\","
-                + "\"messages\": ["
-                + "    {"
-                + "        \"role\": \"user\","
-                + "        \"content\": \"ä½ æ˜¯ä¸€ä¸ªé«˜çº§ç¼–ç¨‹æ¶æ„å¸ˆï¼Œç²¾é€šå„ç±»åœºæ™¯æ–¹æ¡ˆã€æ¶æ„è®¾è®¡å’Œç¼–ç¨‹è¯­è¨€è¯·ï¼Œè¯·æ‚¨æ ¹æ®git diffè®°å½•ï¼Œå¯¹ä»£ç åšå‡ºè¯„å®¡ã€‚ä»£ç ä¸º: " + code + "\""
-                + "    }"
-                + "]"
-                + "}";
-
-        try (OutputStream outputStream = httpURLConnection.getOutputStream()) {
-            byte[] bytes = jsonInpuString.getBytes(StandardCharsets.UTF_8);
-            outputStream.write(bytes);
-        }
-
-        int responseCode = httpURLConnection.getResponseCode();
-        System.out.println(responseCode);
-        String responseMessage = httpURLConnection.getResponseMessage();
-        System.out.println(responseMessage);
-
-        BufferedReader in = new BufferedReader(new InputStreamReader(httpURLConnection.getInputStream()));
-        String inputLine;
-
-        StringBuffer content = new StringBuffer();
-        while ((inputLine = in.readLine()) != null) {
-            content.append(inputLine);
-        }
-
-        in.close();
-        httpURLConnection.disconnect();
-        System.out.println(content.toString());
-
-
-        ChatCompletionSyncResponseDTO response = JSON.parseObject(content.toString(), ChatCompletionSyncResponseDTO.class);
-        System.out.println(response.getChoices().get(0).getMessage().getContent());
-    }
-
-    @Test
-    public void test_wx() {
-        String accessToken = WXAccessTokenUtils.getAccessToken(getEnv("WEIXIN_APPID"), getEnv("WEIXIN_SECRET"));
-        System.out.println(accessToken);
-        Message message = new Message();
-        message.put("repo_name", "big-market");
-        message.put("branch_name", "feat: æ–°åŠ åŠŸèƒ½");
-        message.put("commit_author", "feat: æ–°åŠ åŠŸèƒ½");
-        message.put("commit_message", "feat: æ–°åŠ åŠŸèƒ½");
-
-        String url = String.format("https://api.weixin.qq.com/cgi-bin/message/template/send?access_token=%s", accessToken);
-        System.out.println(JSON.toJSONString(message));
-        sendPostRequest(url, JSON.toJSONString(message));
-    }
-
-    private static void sendPostRequest(String urlString, String jsonBody) {
-        try {
-            URL url = new URL(urlString);
-            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
-            conn.setRequestMethod("POST");
-            conn.setRequestProperty("Content-Type", "application/json; utf-8");
-            conn.setRequestProperty("Accept", "application/json");
-            conn.setDoOutput(true);
-
-            try (OutputStream os = conn.getOutputStream()) {
-                byte[] input = jsonBody.getBytes(StandardCharsets.UTF_8);
-                os.write(input, 0, input.length);
-            }
-
-            try (Scanner scanner = new Scanner(conn.getInputStream(), StandardCharsets.UTF_8.name())) {
-                String response = scanner.useDelimiter("\\A").next();
-                System.out.println(response);
-            }
-        } catch (Exception e) {
-            e.printStackTrace();
-        }
-    }
-
-
-    public static class Message {
-        private String touser = "oavof6xGr7jIjnJ6PkO_9TGKnHD0";
-        private String template_id = "zAIi_1H4cu2Gs_G3ZuqqqwRapX1uft9AmmEaWJUsjN0";
-        private String url = "https://github.com/KeWen-Du/openai-code-review-log/blob/master/2024-08-09/M2xJzbMqMnjK.md";
-
-        private Map<String, Map<String, String>> data = new HashMap<>();
-
-        public void put(String key, String value) {
-            data.put(key, new HashMap<String, String>() {
-                {
-                    put("value", value);
-                }
-            });
-        }
-
-        public String getTouser() {
-            return touser;
-        }
-
-        public void setTouser(String touser) {
-            this.touser = touser;
-        }
-
-        public String getTemplate_id() {
-            return template_id;
-        }
-
-        public void setTemplate_id(String template_id) {
-            this.template_id = template_id;
-        }
-
-        public String getUrl() {
-            return url;
-        }
-
-        public void setUrl(String url) {
-            this.url = url;
-        }
-
-        public Map<String, Map<String, String>> getData() {
-            return data;
-        }
-
-        public void setData(Map<String, Map<String, String>> data) {
-            this.data = data;
-        }
-    }
-
 }


# DKWé¡¹ç›®ï¼š OpenAi ä»£ç è¯„å®¡.
### ğŸ˜€ä»£ç è¯„åˆ†ï¼š70
#### ğŸ˜€ä»£ç é€»è¾‘ä¸ç›®çš„ï¼š
è¯¥ä»£ç æ®µä¸»è¦å®ç°äº†å¯¹ç¯å¢ƒå˜é‡çš„è·å–ã€HTTPè¯·æ±‚çš„å‘é€ä»¥åŠå¾®ä¿¡æ¶ˆæ¯çš„å‘é€ã€‚ç¯å¢ƒå˜é‡è·å–ç”¨äºé…ç½®ä¿¡æ¯ï¼ŒHTTPè¯·æ±‚ç”¨äºä¸å¤–éƒ¨APIé€šä¿¡ï¼Œå¾®ä¿¡æ¶ˆæ¯å‘é€ç”¨äºé€šçŸ¥ç”¨æˆ·ã€‚

#### ğŸ¤”é—®é¢˜ç‚¹ï¼š
1. **ç¯å¢ƒå˜é‡è·å–é”™è¯¯å¤„ç†ä¸å½“**ï¼šåœ¨ `getEnv` æ–¹æ³•ä¸­ï¼Œå½“ç¯å¢ƒå˜é‡ä¸å­˜åœ¨æ—¶ï¼Œç›´æ¥æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œè€Œæ²¡æœ‰è¿›è¡Œæ›´åˆç†çš„é”™è¯¯å¤„ç†ã€‚
2. **ä»£ç ç»“æ„æ··ä¹±**ï¼šæµ‹è¯•ç±» `ApiTest` ä¸­çš„æ–¹æ³•è¿‡äºå¤æ‚ï¼ŒåŒ…å«å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œç¼ºä¹ç»“æ„åŒ–ã€‚
3. **ç¡¬ç¼–ç **ï¼šéƒ¨åˆ†ä»£ç ä¸­å­˜åœ¨ç¡¬ç¼–ç ï¼Œå¦‚API URLã€ç”¨æˆ·IDç­‰ï¼Œä¸åˆ©äºä»£ç çš„ç»´æŠ¤å’Œæ‰©å±•ã€‚
4. **å¼‚å¸¸å¤„ç†ä¸è¶³**ï¼šåœ¨å‘é€HTTPè¯·æ±‚æ—¶ï¼Œæœªå¯¹å¯èƒ½å‡ºç°çš„å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œå¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒã€‚
5. **ä»£ç é‡å¤**ï¼š`sendPostRequest` æ–¹æ³•åœ¨å¤šä¸ªåœ°æ–¹è¢«é‡å¤è°ƒç”¨ï¼Œç¼ºä¹å°è£…å’Œå¤ç”¨ã€‚

#### ğŸ¯ä¿®æ”¹å»ºè®®ï¼š
1. **ä¼˜åŒ–ç¯å¢ƒå˜é‡è·å–**ï¼šåœ¨ `getEnv` æ–¹æ³•ä¸­ï¼Œè¿”å›é»˜è®¤å€¼æˆ–æŠ›å‡ºæ›´å…·ä½“çš„å¼‚å¸¸ã€‚
2. **é‡æ„æµ‹è¯•ç±»**ï¼šå°†æµ‹è¯•ç”¨ä¾‹æ‹†åˆ†ä¸ºå•ç‹¬çš„æµ‹è¯•ç±»ï¼Œæé«˜ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
3. **ç§»é™¤ç¡¬ç¼–ç **ï¼šå°†API URLã€ç”¨æˆ·IDç­‰é…ç½®ä¿¡æ¯æå–åˆ°é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡ä¸­ã€‚
4. **å¢å¼ºå¼‚å¸¸å¤„ç†**ï¼šåœ¨å‘é€HTTPè¯·æ±‚æ—¶ï¼Œå¢åŠ å¼‚å¸¸å¤„ç†é€»è¾‘ï¼Œç¡®ä¿ç¨‹åºçš„ç¨³å®šæ€§ã€‚
5. **å°è£…é‡å¤ä»£ç **ï¼šå°† `sendPostRequest` æ–¹æ³•å°è£…æˆå·¥å…·ç±»ï¼Œæ–¹ä¾¿å¤ç”¨ã€‚

#### ğŸ’»ä¿®æ”¹åçš„ä»£ç ï¼š
```java
// ä¿®æ”¹åçš„ OpenAiCodeReview.java
public class OpenAiCodeReview {
    // ...
    private static String getEnv(String key) {
        String value = System.getenv(key);
        if (value == null || value.isEmpty()) {
            throw new IllegalArgumentException(key + " environment variable is not set");
        }
        return value;
    }
    // ...
}

// ä¿®æ”¹åçš„ ApiTest.java
public class ApiTest {
    // ...
    private static String sendPostRequest(String urlString, String jsonBody) {
        try {
            URL url = new URL(urlString);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Content-Type", "application/json; utf-8");
            conn.setRequestProperty("Accept", "application/json");
            conn.setDoOutput(true);

            try (OutputStream os = conn.getOutputStream()) {
                byte[] input = jsonBody.getBytes(StandardCharsets.UTF_8);
                os.write(input, 0, input.length);
            }

            try (Scanner scanner = new Scanner(conn.getInputStream(), StandardCharsets.UTF_8.name())) {
                return scanner.useDelimiter("\\A").next();
            }
        } catch (Exception e) {
            throw new RuntimeException("Error sending POST request", e);
        }
    }
    // ...
}
```